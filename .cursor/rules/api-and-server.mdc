---
description: API layer and Hono server conventions
globs: client/api/**/*.ts, server/**/*.ts
alwaysApply: false
---

# API and Server

## Client API (client/api/)
- Define endpoints in `api.ts` as objects (e.g. `authority`, `zbt`) with `method` and `url`. Use `API_REQ_FUNCTION` and `RequestConfig` from `client/api/types.ts` for typed requests.
- Use the existing fetch/request helpers and the chain API (`.query()`, `.params()`, `.body()`, `.get()`, `.post()`, etc.) when calling APIs.

## Server (Hono)
- Routes live under `server/routes/`. Mount in `app.ts` with `app.basePath(...).route(...)`.
- Use Honoâ€™s `Context` for request/response. Proxy config in app.ts forwards `/api/*` to `VITE_THIRD_API`; add new proxies in the same style if needed.

## Environment
- Config via `.env.development` / `.env.production`. Use `import.meta.env` in Vite code and `process.env` in Node/server code; `mode` is set for server build.
